<div class="container-fluid">
  <!-- Título -->
  <h2 class="mb-3">Organismo Fiscalizador</h2>

  <!-- Filtros -->
  <div class="row mb-2">
    <!-- Fecha Declaración (Desde / Hasta) -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Fecha Declaración</mat-label>
        <input
          matInput
          [matDatepicker]="picker1"
          [formControl]="fechaDeclaracionDesde"
          placeholder="Desde"
        />
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>&nbsp;</mat-label>
        <input
          matInput
          [matDatepicker]="picker2"
          [formControl]="fechaDeclaracionHasta"
          placeholder="Hasta"
        />
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>
    </div>

    <!-- Fecha de Recepción (Desde / Hasta) -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Fecha de Recepción</mat-label>
        <input
          matInput
          [matDatepicker]="picker3"
          [formControl]="fechaRecepcionDesde"
          placeholder="Desde"
        />
        <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
        <mat-datepicker #picker3></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>&nbsp;</mat-label>
        <input
          matInput
          [matDatepicker]="picker4"
          [formControl]="fechaRecepcionHasta"
          placeholder="Hasta"
        />
        <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
        <mat-datepicker #picker4></mat-datepicker>
      </mat-form-field>
    </div>

    <!-- Tipo Declaración -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Tipo Declaración</mat-label>
        <mat-select [formControl]="tipoDeclaracion">
          <mat-option value="">Todos</mat-option>
          <mat-option value="PRIMERA DECLARACIÓN">PRIMERA DECLARACIÓN</mat-option>
          <mat-option value="ACTUALIZACION PERIÓDICA">ACTUALIZACION PERIÓDICA</mat-option>
          <mat-option value="DECLARACIÓN VOLUNTARIA">DECLARACIÓN VOLUNTARIA</mat-option>
          <!-- Ajusta según tus opciones reales -->
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Estado -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Estado</mat-label>
        <mat-select [formControl]="estado">
          <mat-option value="">Todos</mat-option>
          <mat-option value="FIRMADA">FIRMADA</mat-option>
          <mat-option value="ARCHIVADA">ARCHIVADA</mat-option>
          <mat-option value="RECEPCIONADA">RECEPCIONADA</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div class="row mb-2">
    <!-- R.U.N. Declarante -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>R.U.N. Declarante</mat-label>
        <input
          matInput
          [formControl]="runDeclarante"
          placeholder="R.U.N. DECLARANTE"
        />
      </mat-form-field>
    </div>

    <!-- Nombre Declarante -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Nombre Declarante</mat-label>
        <input
          matInput
          [formControl]="nombreDeclarante"
          placeholder="NOMBRE DECLARANTE"
        />
      </mat-form-field>
    </div>

    <!-- Apellido Paterno -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Apellido Paterno</mat-label>
        <input
          matInput
          [formControl]="apellidoPaterno"
          placeholder="APELLIDO PATERNO"
        />
      </mat-form-field>
    </div>

    <!-- Apellido Materno -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Apellido Materno</mat-label>
        <input
          matInput
          [formControl]="apellidoMaterno"
          placeholder="APELLIDO MATERNO"
        />
      </mat-form-field>
    </div>

    <!-- Servicio -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Servicio</mat-label>
        <input
          matInput
          [formControl]="servicio"
          placeholder="SERVICIO"
        />
      </mat-form-field>
    </div>

    <!-- Cargo -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Cargo</mat-label>
        <input
          matInput
          [formControl]="cargo"
          placeholder="CARGO"
        />
      </mat-form-field>
    </div>
  </div>

  <!-- Botones de acción: Buscar, Limpiar, Exportar -->
  <div class="row mb-3">
    <div class="col-12 d-flex justify-content-end">
      <button mat-raised-button color="primary" class="me-2" (click)="buscar()">
        Buscar
      </button>
      <button mat-raised-button color="warn" class="me-2" (click)="limpiar()">
        Limpiar
      </button>
      <button mat-raised-button color="accent" (click)="exportar()">
        Exportar
      </button>
    </div>
  </div>

  <hr />

  <!-- Título de la Sección: Declaraciones Encontradas -->
  <div class="mb-2">
    <span class="fw-bold">Declaraciones Encontradas</span>
  </div>

  <!-- Botones de descarga (JSON y versión completa) -->
  <div class="mb-2 d-flex align-items-center gap-3">
    <button mat-raised-button color="accent" (click)="descargarVersionCompletaJSON()">
      Descargar declaración (versión completa JSON)
    </button>
    <button mat-raised-button color="warn" (click)="descargarVersionCompleta()">
      Descargar declaración (versión completa)
    </button>
  </div>

  <!-- TABLA -->
  <table mat-table [dataSource]="dataSource" class="small-table mat-elevation-z8 w-100">
    <!-- Cabeceras basadas en la imagen:
         Id Declaración | Fecha de Declaración | Fecha de Recepción | Tipo Declaración
         | Periodo | Numeral | R.U.T. Declarante | Nombre Declarante | Servicio | Cargo | Estado
    -->
    <!-- Id Declaración -->
    <ng-container matColumnDef="idDeclaracion" >
      <th mat-header-cell *matHeaderCellDef>Id Declaración</th>
      <td mat-cell *matCellDef="let element">{{ element.idDeclaracion }}</td>
    </ng-container>

    <!-- Fecha Declaración -->
    <ng-container matColumnDef="fechaDeclaracion" >
      <th mat-header-cell *matHeaderCellDef>Fecha de Declaración</th>
      <td mat-cell *matCellDef="let element">{{ element.fechaDeclaracion }}</td>
    </ng-container>

    <!-- Fecha Recepción -->
    <ng-container matColumnDef="fechaRecepcion" >
      <th mat-header-cell *matHeaderCellDef>Fecha de Recepción</th>
      <td mat-cell *matCellDef="let element">{{ element.fechaRecepcion }}</td>
    </ng-container>

    <!-- Tipo Declaración -->
    <ng-container matColumnDef="tipoDeclaracion" >
      <th mat-header-cell *matHeaderCellDef>Tipo Declaración</th>
      <td mat-cell *matCellDef="let element">{{ element.tipoDeclaracion }}</td>
    </ng-container>

    <!-- Periodo -->
    <ng-container matColumnDef="periodo" >
      <th mat-header-cell *matHeaderCellDef>Periodo</th>
      <td mat-cell *matCellDef="let element">{{ element.periodo }}</td>
    </ng-container>

    <!-- Numeral -->
    <ng-container matColumnDef="numeral" >
      <th mat-header-cell *matHeaderCellDef>Numeral</th>
      <td mat-cell *matCellDef="let element">{{ element.numeral }}</td>
    </ng-container>

    <!-- R.U.T. Declarante -->
    <ng-container matColumnDef="rutDeclarante" >
      <th mat-header-cell *matHeaderCellDef>R.U.T. Declarante</th>
      <td mat-cell *matCellDef="let element">{{ element.rutDeclarante }}</td>
    </ng-container>

    <!-- Nombre Declarante -->
    <ng-container matColumnDef="nombreDeclarante" >
      <th mat-header-cell *matHeaderCellDef>Nombre Declarante</th>
      <td mat-cell *matCellDef="let element">{{ element.nombreDeclarante }}</td>
    </ng-container>

    <!-- Servicio -->
    <ng-container matColumnDef="servicio" >
      <th mat-header-cell *matHeaderCellDef>Servicio</th>
      <td mat-cell *matCellDef="let element">{{ element.servicio }}</td>
    </ng-container>

    <!-- Cargo -->
    <ng-container matColumnDef="cargo" >
      <th mat-header-cell *matHeaderCellDef>Cargo</th>
      <td mat-cell *matCellDef="let element">{{ element.cargo }}</td>
    </ng-container>

    <!-- Estado -->
    <ng-container matColumnDef="estado" >
      <th mat-header-cell *matHeaderCellDef>Estado</th>
      <td mat-cell *matCellDef="let element">{{ element.estado }}</td>
    </ng-container>

    <!-- Filas header y data -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row        *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <!-- Mensaje "Sin Registro de Declaraciones" si el array está vacío -->
  <div class="text-center py-3" *ngIf="dataSource.data?.length === 0">
    <strong>Sin Registro de Declaraciones</strong>
  </div>

  <!-- Paginador, si lo requieres (desactivado en la captura). 
       Podrías agregar un MatPaginator en tu TS si deseas. -->
</div>
