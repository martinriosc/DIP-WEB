<div class="container-fluid">
  <!-- Título -->
  <h2 class="mb-3">Transparencia Pasiva</h2>

  <!-- Filtros -->
  <div class="row mb-2">
    <!-- Fecha Declaración (Desde / Hasta) -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Fecha Declaración</mat-label>
        <input
          matInput
          [matDatepicker]="picker1"
          [formControl]="fechaDeclaracionDesde"
          placeholder="Desde"
        />
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>&nbsp;</mat-label>
        <input
          matInput
          [matDatepicker]="picker2"
          [formControl]="fechaDeclaracionHasta"
          placeholder="Hasta"
        />
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>
    </div>

    <!-- Fecha de Recepción (Desde / Hasta) -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Fecha de Recepción</mat-label>
        <input
          matInput
          [matDatepicker]="picker3"
          [formControl]="fechaRecepcionDesde"
          placeholder="Desde"
        />
        <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
        <mat-datepicker #picker3></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>&nbsp;</mat-label>
        <input
          matInput
          [matDatepicker]="picker4"
          [formControl]="fechaRecepcionHasta"
          placeholder="Hasta"
        />
        <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
        <mat-datepicker #picker4></mat-datepicker>
      </mat-form-field>
    </div>

    <!-- Tipo Declaración -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Tipo Declaración</mat-label>
        <mat-select [formControl]="tipoDeclaracion">
          <mat-option value="">Todos</mat-option>
          <mat-option value="PRIMERA DECLARACIÓN">PRIMERA DECLARACIÓN</mat-option>
          <mat-option value="ACTUALIZACION PERIÓDICA">ACTUALIZACION PERIÓDICA</mat-option>
          <mat-option value="DECLARACIÓN VOLUNTARIA">DECLARACIÓN VOLUNTARIA</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Cargo -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Cargo</mat-label>
        <mat-select [formControl]="cargo">
          <mat-option value="">Todos</mat-option>
          <mat-option value="JEFE DE UNIDAD">JEFE DE UNIDAD</mat-option>
          <mat-option value="ANALISTA">ANALISTA</mat-option>
          <mat-option value="PROFESIONAL">PROFESIONAL</mat-option>
          <!-- Ajusta según tus opciones -->
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div class="row mb-2">
    <!-- Rut Declarante -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Rut Declarante</mat-label>
        <input
          matInput
          [formControl]="rutDeclarante"
          placeholder="Rut Declarante"
        />
      </mat-form-field>
    </div>

    <!-- Nombre Declarante -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Nombre Declarante</mat-label>
        <input
          matInput
          [formControl]="nombreDeclarante"
          placeholder="Nombre Declarante"
        />
      </mat-form-field>
    </div>

    <!-- Apellido Paterno -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Apellido Paterno</mat-label>
        <input
          matInput
          [formControl]="apellidoPaterno"
          placeholder="Apellido Paterno"
        />
      </mat-form-field>
    </div>

    <!-- Apellido Materno -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Apellido Materno</mat-label>
        <input
          matInput
          [formControl]="apellidoMaterno"
          placeholder="Apellido Materno"
        />
      </mat-form-field>
    </div>

    <!-- Servicio -->
    <div class="col-md-2">
      <mat-form-field appearance="outline" class="small-form-field w-100">
        <mat-label>Servicio</mat-label>
        <input
          matInput
          [formControl]="servicio"
          placeholder="CONTRALORIA GENERAL DE LA REPUBLICA"
        />
      </mat-form-field>
    </div>

    <!-- Botones: Buscar, Limpiar, Exportar -->
    <div class="col-md-2 d-flex align-items-center justify-content-end">
      <button
        mat-raised-button
        color="primary"
        class="me-2"
        (click)="buscar()"
      >
        Buscar
      </button>
      <button
        mat-raised-button
        color="warn"
        (click)="limpiar()"
      >
        Limpiar
      </button>
    </div>
  </div>

  <!-- Botón Exportar -->
  <div class="row mb-3">
    <div class="col-12 d-flex justify-content-end">
      <button
        mat-raised-button
        color="accent"
        (click)="exportar()"
      >
        Exportar
      </button>
    </div>
  </div>

  <hr />

  <!-- Sección: Declaraciones Encontradas -->
  <div class="mb-2">
    <span class="fw-bold">Declaraciones Encontradas</span>
    <!-- Botón para descargar (versión pública) a la derecha -->
    <span class="float-end">
      <button
        mat-raised-button
        color="warn"
        (click)="descargarVersionPublica()"
      >
        Descargar declaración (versión pública)
      </button>
    </span>
  </div>

  <!-- TABLA -->
  <table mat-table [dataSource]="dataSource" class="small-table mat-elevation-z8 w-100">
    <!-- Columnas: Id Declaración, Fecha Declaración, Fecha Recepción,
         Tipo Declaración, Numeral, R.U.T. Declarante, Nombre Declarante,
         Servicio, Cargo, Estado
    -->

    <ng-container matColumnDef="idDeclaracion" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Id Declaración</th>
      <td mat-cell *matCellDef="let element">{{ element.idDeclaracion }}</td>
    </ng-container>

    <ng-container matColumnDef="fechaDeclaracion" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Fecha de Declaración</th>
      <td mat-cell *matCellDef="let element">{{ element.fechaDeclaracion }}</td>
    </ng-container>

    <ng-container matColumnDef="fechaRecepcion" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Fecha de Recepción</th>
      <td mat-cell *matCellDef="let element">{{ element.fechaRecepcion }}</td>
    </ng-container>

    <ng-container matColumnDef="tipoDeclaracion" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Tipo Declaración</th>
      <td mat-cell *matCellDef="let element">{{ element.tipoDeclaracion }}</td>
    </ng-container>

    <ng-container matColumnDef="numeral" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Numeral</th>
      <td mat-cell *matCellDef="let element">{{ element.numeral }}</td>
    </ng-container>

    <ng-container matColumnDef="rutDeclarante" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>R.U.T. Declarante</th>
      <td mat-cell *matCellDef="let element">{{ element.rutDeclarante }}</td>
    </ng-container>

    <ng-container matColumnDef="nombreDeclarante" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Nombre Declarante</th>
      <td mat-cell *matCellDef="let element">{{ element.nombreDeclarante }}</td>
    </ng-container>

    <ng-container matColumnDef="servicio" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Servicio</th>
      <td mat-cell *matCellDef="let element">{{ element.servicio }}</td>
    </ng-container>

    <ng-container matColumnDef="cargo" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Cargo</th>
      <td mat-cell *matCellDef="let element">{{ element.cargo }}</td>
    </ng-container>

    <ng-container matColumnDef="estado" appResizableColumn>
      <th mat-header-cell *matHeaderCellDef>Estado</th>
      <td mat-cell *matCellDef="let element">{{ element.estado }}</td>
    </ng-container>

    <!-- Header y filas -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row        *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <!-- Mensaje "Sin Registro de Declaraciones" si la data está vacía -->
  <div class="text-center py-3" *ngIf="dataSource.data.length === 0">
    <strong>Sin Registro de Declaraciones</strong>
  </div>
</div>
